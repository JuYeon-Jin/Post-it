<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>post !t</title>
    <link rel="stylesheet" type="text/css" href="/css/frame.css">
    <link rel="stylesheet" type="text/css" href="/css/post.css">

    <script>

        // 현재 파일의 div에 외부 HTML 내용을 삽입하는 함수
        async function insertExternalHtmlIntoDiv(divId, externalHtmlPath) {
                const divElement = document.getElementById(divId);
                const externalHtmlText = await fetchHtmlAsText(externalHtmlPath);
                divElement.innerHTML = externalHtmlText;

                showPopup();
        }

        // 외부 HTML(url)을 텍스트로 가져오는 함수
        async function fetchHtmlAsText(url) {
            const response = await fetch(url);
            return await response.text();
        }

        // 팝업 띄우기
        function showPopup() {
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('popup').style.display = 'block';

            setTimeout(function() {
                document.getElementById('popup').style.opacity = '1';
            }, 50);
        }

        // 팝업 닫기
        function closeForm() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('popup').style.display = 'none';
            document.getElementById('popup').style.opacity = '0';
        }

        // 글 작성
        function writePost() {
            var form = document.getElementById("writePost");
            alert("testHtml 전송");
            // form.submit();
        }

    </script>

</head>
<body>

<div class="wrapper">
    <!-- 헤더 -->
    <div class="header"><div th:include="header"></div></div>


    <!-- 컨테이너 -->
    <div class="container">
        로그인 확인용 회원정보<br>
        닉네임 : <span th:text="${session.nickName}"></span> 님<br><br>

    <div class="postArea">

        <!-- 게시물 리스트 반복 출력 -->
        <div th:each="post : ${posts}" class="postsBox">
            <div class="postsDate">
                <span th:text="${post.dueDate}"></span>
            </div>
            <div class="postsTitle">
                <span th:text="${post.title}"></span>
            </div>
        </div>

        <!-- 새글 쓰기 -->
        <div class="newPosts">
            <button id="newPostFormBtn" onclick="insertExternalHtmlIntoDiv('popup', '/popupThyme')"
            >+</button>
        </div>

    <div id="popup" class="popup"></div>
    <div id="overlay" class="overlay"></div>

    </div><!-- end.postArea -->
    </div><!-- end.container -->


    <!-- 풋터 -->
    <div class="footer"><div th:include="footer"></div></div>
</div>

</body>
</html>